function LManagerImg(d,b,a){this.lmanager=d;this.src=b;this.base_src="";this.x=0;this.y=0;this.zIndex=0;if(a){for(var c in a){this[c]=a[c]}}this.html_obj=null;this.pendingDraw=true;this.current_src=false}LManagerImg.prototype.redraw=function(){var b=this.base_src+this.src;var c=b.match(/#\w+#/g);if(c){for(var a=0;a<c.length;a++){b=b.replace(c[a],this.lmanager.getVar(c[a].replace(/#/g,"")))}}if(this.html_obj==null){this.html_obj=$('<img src="'+b+'" />').css({position:"absolute"})}else{if(this.current_src!=b){this.html_obj.attr("src",b)}}this.current_src=b;this.html_obj.css({top:this.x+"px",left:this.y+"px",zIndex:this.zIndex})};LManagerImg.prototype.remove=function(){this.html_obj.remove();this.pendingDraw=true};function LManagerLayer(c,a){this.html_obj=$('<div class="layer"></div>');c.container.append(this.html_obj);this.lmanager=c;this.base_src="";this.images={};this.visible=true;this.position="front";this.zIndex=0;if(a){for(var b in a){this[b]=a[b]}}}LManagerLayer.prototype.redraw=function(){for(var a=this.images.length-1;a>=0;a--){this.images[a].redraw();if(this.images[a].pendingDraw){this.html_obj.append(this.images[a].html_obj);this.images[a].pendingDraw=false}}this.html_obj.css({zIndex:this.zIndex,display:this.visible?"block":"none"})};LManagerLayer.prototype.remove=function(){this.html_obj.remove()};LManagerLayer.prototype.setImages=function(b){var f=[];var e=[];var d=false;var c,a;for(a=this.images.length-1;a>=0;a--){d=false;for(c=b.length-1;c>=0;c--){if(this.images[a].src==b[c][0]){f.push(this.images[a]);d=true;break}}if(!d){this.images[a].remove()}}this.images=f;for(c=b.length-1;c>=0;c--){d=false;for(a=this.images.length-1;a>=0;a--){if(this.images[a].src==b[c][0]){d=true;break}}if(!d){this.addImage(b[c][0],b[c][1])}}};LManagerLayer.prototype.addImage=function(c,b){var d={base_src:this.base_src};if(b){d=$.extend(d,b)}var a=new LManagerImg(this.lmanager,c,d);this.images.push(a);return a};LManagerLayer.prototype.removeImages=function(){this.html_obj.html("");this.images=[]};function LManager(a,b){this.container=$(a).css({position:"relative"});if(b){this.op=$.extend({},b)}this.vars={};this.layers={};this.loading=$('<div class="loading"></div>').appendTo(this.container)}LManager.prototype.redraw=function(){this.loading.show();for(var a in this.layers){this.layers[a].redraw()}this.loading.hide()};LManager.prototype.existsLayer=function(a){if(typeof(this.layers[a])=="undefined"){return false}return true};LManager.prototype.addLayer=function(c,b){var d={};if(typeof(b)=="undefined"){d=$.extend(d,b)}var a=new LManagerLayer(this,b);this.layers[c]=a;return a};LManager.prototype.removeLayer=function(a){if(typeof(this.layers[a])=="undefined"){return false}this.layers[a].remove();delete this.layers[a]};LManager.prototype.hideLayer=function(b){try{this.layers[b].visible=false}catch(a){}};LManager.prototype.showLayer=function(b){try{this.layers[b].visible=true}catch(a){}};LManager.prototype.setVar=function(b,a){this.vars[b]=a};LManager.prototype.setVars=function(a){for(var b in a){this.vars[b]=a[b]}};LManager.prototype.getVar=function(a){if(typeof(this.vars[a])!="undefined"){return this.vars[a]}return""};